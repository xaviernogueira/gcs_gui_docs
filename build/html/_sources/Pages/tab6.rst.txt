Extracting Geomorphic Covariance Structure (GCS) series
++++++++++++++++++++++++++++++++++++++++++++++++++++++++
In this step we extract width (W) and mean detrended bed elevation (Z), a inverse proxy for depth, across the longitudinal extent of 
the river segment via dense, evenly spaced, cross-sectional rectangles (see examples). W and Z value are standardized to capture relative cross-sectional geomtry, yielding
Ws and Zs respecively. Cross-sections with Ws > 0 are wider than the mean, and cross-sections with Zs > 0 are shallower (higher bed elevation) than the mean. 
Multiplying Ws and Zs, due to the their standardized nature (see :ref:`Intepreting results`) calculates their covariance at a given cross section, C(Ws,Zs). Each cross-sections W, Z, Ws, Zs, C(Ws, Zs) value
are stored in a csv file that is the basis for Geomorphic Covariance Structure analysis (see :ref:`Literature`).

Inputs
======

- The detrended DEM, *ras_detren.tif*
- Key flow stage elevations separated by commas, ex: *'0.2,0.7,2.6'*
- **USER INPUT:** Cross-section spacing in the same units as the DEM

     * Spacing should be >= DEM resolution. 
     * Typically defined relative to river width. Past analysis used 1/20th of typical bankfull width.
  
- **USER INPUT:** Cross-section lengths for each key flow stage separated by commas, ex: *'200,400,1000'*

     * In the same units as the DEM
     * Must be entered correpsonding to the key flow stage elevation order. ex: *'0.2,0.7,2.6'* / *'200,400,1000'* where 200m cross-sections are used for the 0.2m flow stage.
     * :ref:`See below<Choosing cross-section lengths>` for information on how to approporately define cross-section lengths.
  

Relevant Outputs
=======

Cross-sections are generated at evenly spaced intervals perpendicular to the flow. The cross-sections are converted into rectangles, which are then clipped by a given flow stage 
wetted area polygon. Ideally all the clipped cross-sectional rectangles exhastively cover the wetted area of their respective flow stage. A longitudinal width (W) series
is generatedby dividing the area of each cross-sectional rectnagle by it's height (as defined by the cross-section spacing parameter). The bed elevation (Z) series
is generated by calculating the mean detrended bed elevation value (from the detrended DEM) under each wetted area clipped cross-section rectangle. 

- A new folder, *gcs_tables/* for storing .csv files
- A .csv file for each key flow stage storing the longitudinal W, Z, Ws, Zs, and C(Ws, Zs) series, ex: *gcs_tables/0.2m_gcs_table.csv*
  
     * From upstream to downstream, capturing the topography a flow interacts with along its path.
     * :term:`Flow-convergence routing landforms` designation codes are also stored in the table, faciliating landform analysis.
  
Applied method flow chart
========================= 


Choosing cross-section lengths
==============================